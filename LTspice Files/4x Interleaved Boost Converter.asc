Version 4.1
SHEET 1 3516 1668
WIRE 176 -80 112 -80
WIRE 208 -80 176 -80
WIRE 400 -80 288 -80
WIRE 1072 -80 400 -80
WIRE 1168 -80 1136 -80
WIRE 1312 -80 1264 -80
WIRE 1312 -32 1312 -80
WIRE 1456 -32 1312 -32
WIRE 112 16 112 -80
WIRE 112 16 48 16
WIRE 1312 16 1312 -32
WIRE 176 32 176 -80
WIRE 208 32 176 32
WIRE 576 32 288 32
WIRE 1072 32 576 32
WIRE 1168 32 1168 -80
WIRE 1168 32 1136 32
WIRE 1312 64 1312 16
WIRE 1456 80 1456 48
WIRE 1536 80 1456 80
WIRE 1568 80 1536 80
WIRE 48 96 48 16
WIRE 1168 96 1168 32
WIRE 1456 112 1456 80
WIRE 176 144 176 32
WIRE 208 144 176 144
WIRE 752 144 288 144
WIRE 1072 144 752 144
WIRE 1168 144 1168 96
WIRE 1168 144 1136 144
WIRE 48 160 48 96
WIRE 112 176 112 16
WIRE 1312 176 1312 144
WIRE 1456 224 1456 192
WIRE 176 256 176 144
WIRE 208 256 176 256
WIRE 928 256 288 256
WIRE 1072 256 928 256
WIRE 1168 256 1168 144
WIRE 1168 256 1136 256
WIRE 400 288 400 -80
WIRE 576 288 576 32
WIRE 752 288 752 144
WIRE 928 288 928 256
WIRE 1232 336 1168 336
WIRE 1280 336 1232 336
WIRE 352 368 304 368
WIRE 528 368 480 368
WIRE 704 368 656 368
WIRE 880 368 832 368
WIRE 1440 368 1440 352
WIRE 1552 368 1552 352
WIRE 304 384 304 368
WIRE 480 384 480 368
WIRE 656 384 656 368
WIRE 832 384 832 368
WIRE 48 400 48 240
WIRE 64 400 48 400
WIRE 112 400 112 240
WIRE 112 400 64 400
WIRE 400 400 400 384
WIRE 400 400 112 400
WIRE 576 400 576 384
WIRE 576 400 400 400
WIRE 752 400 752 384
WIRE 752 400 576 400
WIRE 928 400 928 384
WIRE 928 400 752 400
WIRE 1168 400 928 400
WIRE 1232 400 1168 400
WIRE 1280 400 1232 400
WIRE 304 416 304 384
WIRE 480 416 480 384
WIRE 656 416 656 384
WIRE 832 416 832 384
WIRE 64 448 64 400
WIRE 1552 464 1552 448
WIRE 304 560 304 496
WIRE 480 560 480 496
WIRE 656 560 656 496
WIRE 832 560 832 496
WIRE 1664 624 1664 608
WIRE 1760 624 1760 592
WIRE 1776 624 1760 624
WIRE 1904 624 1904 592
WIRE 1904 624 1872 624
WIRE 2064 640 2064 608
WIRE 1600 656 1584 656
WIRE 1632 656 1600 656
WIRE 1728 672 1696 672
WIRE 1744 672 1728 672
WIRE 1760 672 1744 672
WIRE 1776 672 1776 624
WIRE 1776 672 1760 672
WIRE 1872 672 1872 624
WIRE 1872 672 1856 672
WIRE 1904 672 1872 672
WIRE 1760 688 1760 672
WIRE 1776 688 1760 688
WIRE 1728 704 1728 672
WIRE 1760 704 1728 704
WIRE -208 720 -208 656
WIRE 1776 736 1776 688
WIRE 1424 752 1424 720
WIRE 1600 752 1600 656
WIRE 1680 752 1664 752
WIRE 1760 752 1760 704
WIRE 1184 816 1184 800
WIRE -208 832 -208 800
WIRE 1184 832 1184 816
WIRE 1072 864 1072 848
WIRE 1072 880 1072 864
WIRE 960 912 960 896
WIRE 960 928 960 912
WIRE 288 944 288 928
WIRE 368 944 368 928
WIRE 448 944 448 928
WIRE 528 944 528 928
WIRE 848 944 848 928
WIRE 848 960 848 944
WIRE 688 1232 688 1168
FLAG 1312 176 0
FLAG 64 448 0
FLAG 48 96 Vin
FLAG 1312 16 Vout
FLAG 1456 224 0
FLAG 1568 80 Vfb
FLAG 1552 464 0
FLAG 1552 352 Vref
FLAG 1696 640 Vref
FLAG 1664 608 0
FLAG -208 656 Vsaw
FLAG 1168 96 Vout_Node
FLAG 1168 336 Vout_Node
FLAG 1264 -80 Vout_Node
FLAG 1904 672 Vfb
FLAG -208 832 0
FLAG 1584 656 U1_output
FLAG 1424 720 Vcontrol
FLAG 1424 832 0
FLAG 1440 448 0
FLAG 1440 352 Vramp
FLAG 2064 720 0
FLAG 2064 608 Vcc
FLAG 1664 688 Vcc
FLAG 1744 672 Ve
FLAG 1536 144 0
FLAG 304 640 0
FLAG 480 640 0
FLAG 656 640 0
FLAG 832 640 0
FLAG 688 1312 0
FLAG 688 1168 N_avg
FLAG 288 1024 0
FLAG 368 1024 0
FLAG 448 1024 0
FLAG 528 1024 0
FLAG 288 928 N_dI1
FLAG 368 928 N_dI2
FLAG 448 928 N_dI3
FLAG 528 928 N_dI4
FLAG 848 1120 0
FLAG 960 1088 0
FLAG 1072 1040 0
FLAG 1184 992 0
FLAG 848 928 N_ctrl1
FLAG 960 896 N_ctrl2
FLAG 1072 848 N_ctrl3
FLAG 1184 800 N_ctrl4
FLAG 1776 800 0
FLAG 784 944 0
FLAG 896 912 0
FLAG 1008 864 0
FLAG 1120 816 0
FLAG 304 384 Pwm_1
FLAG 480 384 Pwm_2
FLAG 656 384 Pwm_3
FLAG 832 384 Pwm_4
SYMBOL ind 192 -64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 180µ
SYMBOL ind 192 48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 180µ
SYMBOL ind 192 160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value 180µ
SYMBOL ind 192 272 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value 180µ
SYMBOL nmos 704 288 R0
WINDOW 3 34 6 Left 2
SYMATTR Value BSC100N10NSF
SYMATTR InstName M3
SYMBOL diode 1072 -64 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value RB058LAM150
SYMBOL cap 1152 336 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL res 1296 48 R0
SYMATTR InstName Rload
SYMATTR Value 33.3
SYMBOL voltage 48 144 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -125 102 Left 2
SYMATTR Value PWL(0 0 4m 28)
SYMATTR InstName Vin
SYMBOL cap 96 176 R0
SYMATTR InstName C2
SYMATTR Value 60µ
SYMBOL diode 1072 48 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value RB058LAM150
SYMBOL diode 1072 160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value RB058LAM150
SYMBOL diode 1072 272 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value RB058LAM150
SYMBOL nmos 352 288 R0
WINDOW 3 14 5 Left 2
SYMATTR Value BSC100N10NSF
SYMATTR InstName M1
SYMBOL nmos 528 288 R0
WINDOW 3 24 6 Left 2
SYMATTR Value BSC100N10NSF
SYMATTR InstName M2
SYMBOL nmos 880 288 R0
SYMATTR InstName M4
SYMATTR Value BSC100N10NSF
SYMBOL res 464 400 R0
SYMATTR InstName R4
SYMATTR Value 2.2
SYMBOL res 288 400 R0
SYMATTR InstName R5
SYMATTR Value 2.2
SYMBOL res 640 400 R0
SYMATTR InstName R2
SYMATTR Value 2.2
SYMBOL res 816 400 R0
SYMATTR InstName R3
SYMATTR Value 2.2
SYMBOL res 1440 -48 R0
SYMATTR InstName R6
SYMATTR Value 97.5k
SYMBOL res 1440 96 R0
SYMATTR InstName R8
SYMATTR Value 2.5k
SYMBOL OpAmps\\UniversalOpAmp2 1664 656 R180
SYMATTR InstName U1
SYMBOL voltage 1552 352 R0
WINDOW 3 24 44 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 4m 2.5v)
SYMATTR InstName V1
SYMBOL res 1872 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 12k
SYMBOL voltage -208 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PWL REPEAT FOREVER file=sawtooth.txt ENDREPEAT
SYMBOL bv 1424 736 R0
SYMATTR InstName B6
SYMATTR Value V = (V(U1_output) < V(Vramp) ? V(U1_output) : V(Vramp)) / 9.5
SYMBOL voltage 1440 352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PWL(1m 0 4m 9.5)
SYMBOL voltage 2064 624 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 9.5v
SYMBOL cap 1664 736 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 150n
SYMBOL res 1776 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 6.8k
SYMBOL cap 1520 80 R0
SYMATTR InstName C4
SYMATTR Value 1.5n
SYMBOL bv 304 544 R0
WINDOW 3 -1101 -60 Left 2
SYMATTR Value V = (V(N_ctrl1) > (V(Vsaw) + 0.00 < 1 ? V(Vsaw) + 0.00 : V(Vsaw) + 0.00 - 1)) ? 12 : 0
SYMATTR InstName B5
SYMBOL bv 480 544 R0
WINDOW 3 -1280 -31 Left 2
SYMATTR Value V = (V(N_ctrl2) > (V(Vsaw) + 0.25 < 1 ? V(Vsaw) + 0.25 : V(Vsaw) + 0.25 - 1)) ? 12 : 0
SYMATTR InstName B7
SYMBOL bv 656 544 R0
WINDOW 3 -1455 -2 Left 2
SYMATTR Value V = (V(N_ctrl3) > (V(Vsaw) + 0.50 < 1 ? V(Vsaw) + 0.50 : V(Vsaw) + 0.50 - 1)) ? 12 : 0
SYMATTR InstName B8
SYMBOL bv 832 544 R0
WINDOW 3 -1632 30 Left 2
SYMATTR Value V = (V(N_ctrl4) > (V(Vsaw) + 0.75 < 1 ? V(Vsaw) + 0.75 : V(Vsaw) + 0.75 - 1)) ? 12 : 0
SYMATTR InstName B9
SYMBOL bv 688 1216 R0
SYMATTR InstName B10
SYMATTR Value V = (I(L1) + I(L2) + I(L3) + I(L4)) / 4
SYMBOL bv 288 928 R0
WINDOW 3 -7 128 Left 2
SYMATTR Value V = I(L1) - V(N_avg)
SYMATTR InstName B11
SYMBOL bv 368 928 R0
WINDOW 3 -10 106 Left 2
SYMATTR Value V = I(L2) - V(N_avg)
SYMATTR InstName B12
SYMBOL bv 448 928 R0
WINDOW 3 -10 86 Left 2
SYMATTR Value V = I(L3) - V(N_avg)
SYMATTR InstName B13
SYMBOL bv 528 928 R0
WINDOW 3 -9 67 Left 2
SYMATTR Value V = I(L4) - V(N_avg)
SYMATTR InstName B14
SYMBOL bv 848 1024 R0
WINDOW 3 -2 135 Left 2
SYMATTR Value V = V(Vcontrol) - 0.2 * V(N_dI1)
SYMATTR InstName B15
SYMBOL bv 960 992 R0
WINDOW 3 -6 113 Left 2
SYMATTR Value V = V(Vcontrol) - 0.2 * V(N_dI2)
SYMATTR InstName B16
SYMBOL bv 1072 944 R0
WINDOW 3 -9 93 Left 2
SYMATTR Value V = V(Vcontrol) - 0.2 * V(N_dI3)
SYMATTR InstName B17
SYMBOL bv 1184 896 R0
WINDOW 3 -6 72 Left 2
SYMATTR Value V = V(Vcontrol) - 0.2 * V(N_dI4)
SYMATTR InstName B18
SYMBOL cap 1216 336 R0
SYMATTR InstName C5
SYMATTR Value 1µ
SYMBOL cap 1760 736 R0
SYMATTR InstName C6
SYMATTR Value 15n
SYMBOL cap 1904 576 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 68p
SYMBOL res 1856 576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 220
SYMBOL res 832 944 R0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL cap 848 928 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 10n
SYMBOL res 944 912 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 1056 864 R0
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL res 1168 816 R0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL cap 960 896 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 10n
SYMBOL cap 1072 848 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 10n
SYMBOL cap 1184 800 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value 10n
SYMBOL cap 1264 336 R0
SYMATTR InstName C12
SYMATTR Value 0.1µ
TEXT 2664 -296 Left 2 !.meas Pin AVG (V(Vin)*I(Vin)) FROM 50ms TO 60ms\n.meas Pout AVG (V(Vout)*I(Rload)) FROM 50ms TO 60ms\n.measure Efficiency PARAM 100*Pout/Pin
TEXT 3360 -296 Left 2 !.tran 60m uic
TEXT 2656 -144 Left 2 !.measure TRAN Vout_max MAX V(Vout) FROM=40m TO=60m\n.measure TRAN Vout_min MIN V(Vout) FROM=40m TO=60m\n.measure TRAN Ripple PARAM Vout_max - Vout_min
TEXT 2656 -48 Left 2 !.measure TRAN I_L1_avg AVG I(L1) FROM=40m TO=60m\n.measure TRAN I_L2_avg AVG I(L2) FROM=40m TO=60m\n.measure TRAN I_L3_avg AVG I(L3) FROM=40m TO=60m\n.measure TRAN I_L4_avg AVG I(L4) FROM=40m TO=60m
TEXT 2664 64 Left 2 !.measure TRAN I_L1_peak MAX I(L1) FROM=0 TO=20m\n.measure TRAN I_L2_peak MAX I(L2) FROM=0 TO=20m\n.measure TRAN I_L3_peak MAX I(L3) FROM=0 TO=20m\n.measure TRAN I_L4_peak MAX I(L4) FROM=0 TO=20m
TEXT 2672 176 Left 2 !.measure TRAN StartupTime WHEN V(Vout)=99.5 RISE=1 TD=1m
TEXT 2680 208 Left 2 !.measure TRAN Vout_avg AVG V(Vout) FROM=40m TO=60m\n.measure TRAN Iout_avg AVG I(Rload) FROM=40m TO=60m
